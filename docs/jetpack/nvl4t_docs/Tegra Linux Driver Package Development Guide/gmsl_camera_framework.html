<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- NVIDIA customization --><title>NVIDIA Jetson Linux Driver Package Software Features : Camera Development | NVIDIA Docs </title><link rel="Prev" href="camera_sensor_prog.47.2.html" title="Previous" /><link rel="Next" href="sensor_processing_engine.html" title="Next" /><link rel="StyleSheet" href="../css/font-awesome/css/font-awesome.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/gmsl_camera_framework.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><noscript><div id="noscript_padding"></div></noscript></head><body id="pq26drT1TeeNxDhgwEgSK_002bw" class="ww_skin_page_body" style="visibility: hidden;"><input type="hidden" id="page_onload_url" value="../index.html#page/Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html"></input><span id="dropdown_ids" style="display:none;"></span><div id="ww_content_container"><header id="wwconnect_header"><div class="ww_skin_page_toolbar"><div id="dropdown_button_container" class="dropdown_container dropdown_button_container_disabled"><a id="show_hide_all" class="ww_skin ww_behavior_dropdown_toggle ww_skin_dropdown_toggle" title="Page DropDown Toggle" href="#"><i class="fa"></i></a><span class="ww_skin_page_toolbar_divider">&nbsp;</span></div><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#"><i class="fa"></i></a></div><!-- was this helpful button --><!--                         --></header><div id="page_content_container" style="background-attachment: scroll; background-image: url(&quot;watermark.png&quot;); background-position: center center; background-repeat: no-repeat; margin-left: 0pt; margin-right: 10pt; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px"><div id="page_content"><H1 id="wwpID0E0IK0HA" class="Heading_2_Top">Jetson Virtual Channel with GMSL Camera Framework</H1><div class="WebWorks_MiniTOC"><div class="WebWorks_MiniTOC_Heading">&nbsp;</div><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E05J0HA">Platforms</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0YJ0HA">GMSL Protocol</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0UJ0HA">GMSL Camera</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0KJ0HA">CSI Connectivity</a></div></dd><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0GJ0HA">Jetson TX2</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0CJ0HA">Jetson AGX Xavier</a></div></dd></dl><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0ZI0HA">Hardware Module Connectivity</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0UI0HA">Software Framework and Programming</a></div></dd><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0QI0HA">Driver Framework</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E02H0HA">Device Tree Programming</a></div></dd></dl><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0ESHA">Constraints</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0EPHA">Validation</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0EMHA">Known Issues</a></div></dd><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0EKHA">General Issues</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0EHHA">Xavier-Specific</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0ECHA">Plugin Manager Board ID</a></div></dd></dl></dl></div><div id="wwpID0E0HK0HA" class="Body_Text_Indent"><span class="Strong">Applies to</span>: Jetson AGX Xavier series and Jetson TX2 series</div><div id="wwpID0E0GK0HA" class="Body_Text">This topic contains details about:</div><div id="wwpID0E0FK0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt; font-style: normal">•	</span></span><span class="Emphasis" style="font-style: normal">The Gigabit Multimedia Serial Link (GMSL) protocol</span></div><div id="wwpID0E0EK0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt; font-style: normal">•	</span></span><span class="Emphasis" style="font-style: normal">Hardware connectivity for the serializer/deserializer in the reference module (see </span><span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E05J0HA" title="Jetson Virtual Channel with GMSL Camera Framework">Platforms</a></span><span class="Emphasis" style="font-style: normal">)</span></div><div id="wwpID0E0DK0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt; font-style: normal">•	</span></span><span class="Emphasis" style="font-style: normal">The software framework</span></div><div id="wwpID0E0CK0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt; font-style: normal">•	</span></span><span class="Emphasis" style="font-style: normal">Configuration, including virtual channel programming</span></div><div id="wwpID0E0BK0HA" class="Body_Text"><span class="Emphasis" style="font-style: normal">NVIDIA validates the reference module on NVIDIA</span><span class="Emphasis" style="font-style: normal; vertical-align: super">®</span><span class="Emphasis" style="font-style: normal"> Jetson™ TX2 and NVIDIA</span><span class="Emphasis" style="font-style: normal; vertical-align: super">®</span><span class="Emphasis" style="font-style: normal"> Jetson AGX Xavier™ platforms with Sony IMX390 sensors as source. However, the reference module can be used as a starting point for bringing up another GMSL module on Jetson TX2 and Jetson AGX Xavier.</span></div><div id="wwpID0E0AK0HA" class="Body_Text"><span class="Emphasis" style="font-style: normal">The software framework described in this document can be used as reference for developing </span><span class="Strong">SerDes</span><span class="Emphasis" style="font-style: normal"> </span>(Serializer-Deserializer) <span class="Emphasis" style="font-style: normal">links other than GMSL.</span></div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 0.9pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 54pt"><div id="wwpID0EABA06J0HA" class="Normal" style="margin-bottom: 0pt; margin-top: 6pt; text-align: center"><span style="font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 382.5pt"><div id="wwpID0EAAA06J0HA" class="Normal" style="margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">The reference GMSL module described here uses the CSI interface. No other interface is validated.</span></div></td></tr></table></div><H3 id="wwpID0E05J0HA" class="Heading_3">Platforms</H3><div id="wwpID0E04J0HA" class="Body_Text">GMSL and other aggregators are not supported on NVIDIA<span style="vertical-align: super">®</span> Jetson Nano™ devices and NVIDIA<span style="vertical-align: super">®</span> Jetson™ TX1 platforms, as they do not support virtual channels. This document applies to Jetson AGX Xavier series and Jetson TX2 platforms only.</div><div id="wwpID0E03J0HA" class="Body_Text">The reference GMSL setup is:</div><div id="wwpID0E02J0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>Sensor: Sony dual IMX390, RAW12/1080p/30fps, CSI port A, x2 lanes</div><div id="wwpID0E01J0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>Serializer: Maxim MAX9295</div><div id="wwpID0E0ZJ0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>Deserializer: Maxim MAX9296</div><H3 id="wwpID0E0YJ0HA" class="Heading_3">GMSL Protocol</H3><div id="wwpID0E0XJ0HA" class="Body_Text">Maxim Integrated supports GMSL as a communication link for video applications in the automotive industry. GMSL is based on SerDes (Serializer-Deserializer) technology; that is, it uses a serializer on the transmitting side and a deserializer on the receiving side. The following diagram shows the high-level architecture of GMSL.</div><div class="ww_skin_page_overflow"><div id="wwpID0E0WJ0HA" class="Body_Text" style="text-indent: 0pt"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.01.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><div id="wwpID0E0VJ0HA" class="Body_Text">GMSL is specifically designed for use in Advanced Driver Assistance Systems (ADAS) and Camera Monitoring Systems (CMS). It can provide video transfer speeds up to 6&nbsp;GB/second. It uses STP or coaxial cable, which are both inexpensive and very robust for EMC disturbances.</div><H3 id="wwpID0E0UJ0HA" class="Heading_3">GMSL Camera</H3><div id="wwpID0E0TJ0HA" class="Body_Text">The following diagram shows the control, data, and clock connections for the reference GMSL module validated on Jetson AGX Xavier and Jetson TX2.</div><div class="ww_skin_page_overflow"><div id="wwpID0E0SJ0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.02.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><div id="wwpID0E0RJ0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>In this GMSL setup, two sensors are paired with their respective serializers, each streaming 1080p/30fps RAW12 pixels over x2 CSI MIPI lanes.</div><div id="wwpID0E0QJ0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>The serializers are connected to a GMSL deserializer device through different GMLS ports (ports A and B) and GMSL links using coaxial cables.</div><div id="wwpID0E0PJ0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>On the output port side, the deserializer is connected to a Jetson TX2 or Jetson AGX Xavier SoC on the desired CSI port (port A in this example).</div><div id="wwpID0E0OJ0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>To transmit two different pixel streams from two sensors to a receiver at a shared CSI port, the deserializer assigns a unique virtual channel ID to each stream. The virtual channel ID is software-configurable via the device tree. It must match the stream’s virtual channel ID programmed on the receiver side in the NVIDIA SoC.</div><div id="wwpID0E0NJ0HA" class="Body_Text">This reference GMSL setup uses a 2x (x2/x4/x1) CSI deserializer. It can host up to two sensors via serializers.</div><div id="wwpID0E0MJ0HA" class="Body_Text">To host four sensors over single shared CSI port you must use a 4x aggregator, as shown in the following diagram:</div><div class="ww_skin_page_overflow"><div id="wwpID0E0LJ0HA" class="Body_Text"> <img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.03.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><H3 id="wwpID0E0KJ0HA" class="Heading_3">CSI Connectivity</H3><div id="wwpID0E0JJ0HA" class="Body_Text">The table below shows the maximum number of sensor connections supported on each Jetson platform.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 35.75pt" cellspacing="0" summary=""><tr><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.75pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.75pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 148.5pt" rowspan="2"><div id="wwpID0EABE0IJ0HA" class="Cell_Heading">Configuration</div></th><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.75pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.75pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 180pt" colspan="2"><div id="wwpID0EAAE0IJ0HA" class="Cell_Heading">Maximum Connections Supported</div></th></tr><tr><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.75pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.75pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.75pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 90pt"><div id="wwpID0EABD0IJ0HA" class="Cell_Heading">Jetson TX2</div></th><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.75pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.75pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 90pt"><div id="wwpID0EAAD0IJ0HA" class="Cell_Heading">Jetson AGX&nbsp;Xavier</div></th></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 148.5pt"><div id="wwpID0EACC0IJ0HA" class="Cell_Text">No aggregator</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 90pt"><div id="wwpID0EABC0IJ0HA" class="Cell_Text" style="text-align: center">6</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 90pt"><div id="wwpID0EAAC0IJ0HA" class="Cell_Text" style="text-align: center">6</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EACB0IJ0HA" class="Cell_Text">Aggregator with ISP</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABB0IJ0HA" class="Cell_Text" style="text-align: center">12</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAB0IJ0HA" class="Cell_Text" style="text-align: center">16</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EACA0IJ0HA" class="Cell_Text">Aggregator without ISP</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA0IJ0HA" class="Cell_Text" style="text-align: center">12</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAA0IJ0HA" class="Cell_Text" style="text-align: center">24</div></td></tr></table></div><H4 id="wwpID0E0GJ0HA" class="Heading_4">Jetson TX2</H4><div id="wwpID0E0FJ0HA" class="Body_Text">The maximum number of virtual channels supported on Jetson TX2 is 12 via three 4x aggregators connected to each of the CSI bricks in <span class="Code_Char">x4</span>, <span class="Code_Char">x2</span>, or <span class="Code_Char">x1</span> lane configuration (of any valid combination of them).</div><div class="ww_skin_page_overflow"><div id="wwpID0E0EJ0HA" class="Body_Text"> <img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.04.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><div id="wwpID0E0DJ0HA" class="Body_Text">The diagram above shows Jetson TX2 connections for 12 cameras with virtual channels.</div><H4 id="wwpID0E0CJ0HA" class="Heading_4">Jetson AGX Xavier</H4><div id="wwpID0E0BJ0HA" class="Body_Text">Jetson AGX Xavier supports a maximum of 16 virtual channels with ISP, or 24 virtual channels without ISP.</div><div class="ww_skin_page_overflow"><div id="wwpID0E0AJ0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.05.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><div id="wwpID0E06I0HA" class="Body_Text">The diagram above shows sensor connections to each of the NVIDIA<span style="vertical-align: super">®</span> Xavier™ CSI bricks (a total of 4&nbsp;CSI bricks) in <span class="Code_Char">x4</span> or /<span class="Code_Char">x2</span> or /<span class="Code_Char">x1</span> possible lane configuration.</div><div class="ww_skin_page_overflow"><div id="wwpID0E05I0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.06.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><div id="wwpID0E04I0HA" class="Body_Text">The diagram above shows four sensors connected to each port of CSI bricks AB and CD in <span class="Code_Char">x2</span> or <span class="Code_Char">x1</span> lane configuration, and four sensors connected to each of the remaining CSI bricks EF and GH in <span class="Code_Char">x4</span>, <span class="Code_Char">x2</span>, or <span class="Code_Char">x1</span> lane configuration.</div><div id="wwpID0E03I0HA" class="Body_Text">The CSI aggregator uses virtual channels to connect to four cameras over one CSI connection.</div><div id="wwpID0E02I0HA" class="Body_Text">The Jetson TX2 or Jetson AGX Xavier VI muxer sends each camera frame to a different location in memory.</div><div id="wwpID0E01I0HA" class="Body_Text">In software, each camera appears as a separate V4L2 device.</div><H3 id="wwpID0E0ZI0HA" class="Heading_3">Hardware Module Connectivity</H3><div id="wwpID0E0YI0HA" class="Body_Text">The figure below shows how two sensors are connected to a Jetson AGX Xavier device using a GMSL reference module and a MAX9295/MAX9296 SerDes. Two sensors may be connected to a Jetson TX2 the same way.</div><div id="wwpID0E0XI0HA" class="Body_Text">The GMSL MAX9296 deserializer is connected to the Jetson platform via a MIPI adapter and MIPI white cables, which are plugged into the platform’s camera connector socket. This is one of several ways the aggregator hardware module can be connected to the Jetson platform.</div><div class="ww_skin_page_overflow"><div id="wwpID0E0WI0HA" class="Body_Text" style="text-indent: 0pt"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.07.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><div id="wwpID0E0VI0HA" class="Body_Text">&nbsp;</div><H3 id="wwpID0E0UI0HA" class="Heading_3">Software Framework and Programming</H3><div id="wwpID0E0TI0HA" class="Body_Text">This section describes the kernel drivers and device tree programming required for GMSL and virtual channel.</div><div id="wwpID0E0SI0HA" class="Body_Text">The following diagram shows the high-level architecture of the kernel drivers and devices.</div><div class="ww_skin_page_overflow"><div id="wwpID0E0RI0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.08.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><H4 id="wwpID0E0QI0HA" class="Heading_4">Driver Framework</H4><div id="wwpID0E0PI0HA" class="Body_Text">As shown in the diagram above, there are separate kernel drivers for serializer and deserializer devices, apart from the sensor driver. In the reference module they are the MAX9295 serializer and MAX9296 deserializer drivers.</div><div id="wwpID0E0OI0HA" class="Body_Text">In this framework, the sensor driver is exposed to the rest of the system as would be any other generic V4L2 sensor driver without external aggregator. All of the SerDes programming happens “under the hood” through the sensor driver.</div><div id="wwpID0E0NI0HA" class="Body_Text">The SerDes kernel drivers are not registered as client programmable and isolated devices V4L2 or any other sensor framework.</div><div id="wwpID0E0MI0HA" class="Body_Text">The reason for this design is that a certain fixed sequence of operations must be performed in the SerDes, and it does not quite fit the generic V4L2 framework sequence for sensors.</div><div id="wwpID0E0LI0HA" class="Body_Text">SerDes drivers are separate, though. They can be statically linked to any sensors in the device tree, depending on hardware connectivity, but they are controlled by the sensor driver only. They do not expose any programmable functionality directly to user clients.</div><div id="wwpID0E0KI0HA" class="Body_Text">A sensor driver internally links to the SerDes drivers to perform device and stream control operations such as power on/off, control setup/release, stream setup/release, and stream start/stop, based on device tree configuration.</div><div id="wwpID0E0JI0HA" class="Heading_5">Driver Programming</div><div id="wwpID0E0II0HA" class="Body_Text">The serializer/deserializer drivers control the serializer/deserializer modules through the serializer/deserializer API, described in <span class="Hyperlink"><a href="https://docs.nvidia.com/jetson/l4t-multimedia/index.html" target="external_window">Jetson Linux Drive Package API References</a></span>.</div><div id="wwpID0E0HI0HA" class="Body_Text">The structure <span class="Code_Char">gmsl_link_ctx</span> is the core entity which defines the entire link configuration from sensor to serializer link to deserializer link for each sensor source. It is documented in the <span class="Emphasis">API References</span>.</div><div id="wwpID0E0GI0HA" class="Body_Text">Most of the structure fields are populated by the sensor driver from the sensor’s <span class="Code_Char">gmsl-link</span> node in the device tree during device boot. (See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0WF0HA" title="Jetson Virtual Channel with GMSL Camera Framework">Module Device Tree</a></span> for node details.) Some of the fields are populated by the serializer and deserializer drivers.</div><div id="wwpID0E0FI0HA" class="Body_Text">The sensor driver populates an instance of the structure and passes it to the serializer and deserializer drivers, which make use of the configuration details found in the structure context during power-on, control pipeline setup, and data streaming pipeline setup calls.</div><div id="wwpID0E0EI0HA" class="Body_Text">As defined in this structure, the sensor and its corresponding serializer device each have a <span style="font-weight: bold">physical I2C slave</span> <span class="Strong">address</span>, assigned according to the device data sheet, and a <span style="font-weight: bold">proxy I2C slave address</span>, which is user-defined.</div><div id="wwpID0E0DI0HA" class="Body_Text">The reason for this is that all of the devices sharing the same hardware connection in the GMSL setup must be identified to the I2C bus with unique physical I2C slave addresses. The physical I2C slave address of each device is fixed, and is the same for similar types of devices, such as all sensor devices of a single make and model that are assigned to same slave. This causes address conflicts. To resolve the conflicts the driver uses a different proxy I2C slave address for each such device. The proxy I2C slave addresses are set statically in the device tree, and are assigned during device boot.</div><div id="wwpID0E0CI0HA" class="Body_Text">The following diagram shows the call flow among the GMSL kernel drivers during device boot.</div><div class="ww_skin_page_overflow"><div id="wwpID0E0BI0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.09.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><div id="wwpID0E0AI0HA" class="Body_Text">Power management is handled by the shared deserializer driver instead of the sensor driver because each sensor device’s driver is unaware of other sensor devices in the GMSL module setup, but the deserializer device is common among all of the sensors connected to it.</div><div id="wwpID0E06H0HA" class="Body_Text">The stream-on and stream-off calls are mapped directly to the serializer and deserializer drivers.</div><div id="wwpID0E05H0HA" class="Body_Text">Stream setup is required for both SerDes drivers, whereas stream-on and stream-off are controlled by the deserializer driver only.</div><div id="wwpID0E04H0HA" class="Body_Text">The following figure shows the call flow among the GMSL kernel drivers for a stream-on or stream-off operation.</div><div class="ww_skin_page_overflow"><div id="wwpID0E03H0HA" class="Body_Text"><img class="Default" src="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/images/gmsl_camera_framework.1.10.jpg" style="display: inline; left: 0pt; top: 0pt" alt="" title="" /></div></div><H4 id="wwpID0E02H0HA" class="Heading_4">Device Tree Programming</H4><div id="wwpID0E01H0HA" class="Body_Text">The device tree describes the hardware connections to the system as well as the static device properties of the drivers.</div><div id="wwpID0E0ZH0HA" class="Heading_5">Platform Device Tree</div><div id="wwpID0E0YH0HA" class="Body_Text">Hardware connections and device addressing are configured in the platform device tree.</div><div id="wwpID0E0XH0HA" class="Body_Text">As explained in <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/gmsl_camera_framework.html#wwpID0E0JI0HA" title="Jetson Virtual Channel with GMSL Camera Framework">Driver Programming</a></span>, each sensor and serializer device has two addresses: a physical I2C slave address and a proxy I2C slave address. Both are defined in the platform device tree.</div><div id="wwpID0E0WH0HA" class="Body_Text">In the reference GMSL module both sensors have the physical I2C slave address <span class="Code_Char">0x1a</span>, but must be assigned distinct proxy addresses. The proxy I2C slave addresses are user-configurable, by default <span class="Code_Char">0x1b</span> and <span class="Code_Char">0x1c</span>.</div><div id="wwpID0E0VH0HA" class="Body_Text">Similarly, for serializer devices the physical I2C slave address is <span class="Code_Char">0x62</span>, and the proxy I2C slave addresses are user-configurable, by default <span class="Code_Char">0x40</span> and <span class="Code_Char">0x60</span>.</div><div id="wwpID0E0UH0HA" class="Body_Text">The following table shows the I2C slave address assignments for the reference GMSL setup.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 35.75pt" cellspacing="0" summary=""><tr><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.75pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.5pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.75pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 130.5pt" rowspan="2"><div id="wwpID0EABD0TH0HA" class="Cell_Heading">&nbsp;</div></th><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.75pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.75pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.5pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 261pt" colspan="5"><div id="wwpID0EAAD0TH0HA" class="Cell_Heading">I2C Slave Address Assignments</div></th></tr><tr><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.75pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.75pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.75pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 49.5pt"><div id="wwpID0EAEC0TH0HA" class="Cell_Heading">Sensor1</div></th><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.75pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.75pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.75pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 54pt"><div id="wwpID0EADC0TH0HA" class="Cell_Heading">Sensor2</div></th><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.75pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.75pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.75pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 54pt"><div id="wwpID0EACC0TH0HA" class="Cell_Heading">Ser1</div></th><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.75pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.75pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.75pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 54pt"><div id="wwpID0EABC0TH0HA" class="Cell_Heading">Ser2</div></th><th style="background-color: #DDEEBF; border-bottom-color: #7F7F7F; border-bottom-style: solid; border-bottom-width: 0.5pt; border-left-color: #7F7F7F; border-left-style: solid; border-left-width: 0.75pt; border-right-color: #7F7F7F; border-right-style: solid; border-right-width: 0.5pt; border-top-color: #7F7F7F; border-top-style: solid; border-top-width: 0.75pt; padding-bottom: 0pt; padding-left: 0pt; padding-right: 0pt; padding-top: 0pt; vertical-align: bottom; width: 49.5pt"><div id="wwpID0EAAC0TH0HA" class="Cell_Heading">Des</div></th></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 130.5pt"><div id="wwpID0EAFB0TH0HA" class="Cell_Text">Physical I2C slave address</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EAEB0TH0HA" class="Cell_Text" style="text-align: center">0x1a</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 54pt"><div id="wwpID0EADB0TH0HA" class="Cell_Text" style="text-align: center">0x1a</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 54pt"><div id="wwpID0EACB0TH0HA" class="Cell_Text" style="text-align: center">0x62</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 54pt"><div id="wwpID0EABB0TH0HA" class="Cell_Text" style="text-align: center">0x62</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EAAB0TH0HA" class="Cell_Text" style="text-align: center">0x48</div></td></tr><tr><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAFA0TH0HA" class="Cell_Text">Proxy I2C slave address</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAEA0TH0HA" class="Cell_Text" style="text-align: center">0x1b</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EADA0TH0HA" class="Cell_Text" style="text-align: center">0x1c</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EACA0TH0HA" class="Cell_Text" style="text-align: center">0x40</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EABA0TH0HA" class="Cell_Text" style="text-align: center">0x60</div></td><td style="background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top"><div id="wwpID0EAAA0TH0HA" class="Cell_Text" style="text-align: center">NA</div></td></tr></table></div><div id="wwpID0E0SH0HA" class="Body_Text">Each sensor device initiates a <span class="Code_Char">power_on</span> request to the deserializer driver to perform GMSL link configuration and power on the shared deserializer device. In this power-on call, the deserializer driver only enables the GMSL link to which the caller’s sensor device is connected, and keeps other one disabled, so that there will be no address conflict between the two links. It then updates all devices’ proxy I2C slave addresses on the active link to the ones defined in the device tree. It follows the same procedure for the other GMSL link when the deserializer driver gets a <span class="Code_Char">power_on</span> request from the sensor device connected to the other GMSL link. In this way, the deserializer driver updates all of the proxy I2C save addresses of all devices hosted by the deserializer device.</div><div id="wwpID0E0RH0HA" class="Body_Text">For example, in the reference GMSL setup, when the deserializer gets a power-on request from the sensor device connected to link A, it enables GMSL link A and disables GMSL link B. It first communicates to the serializer and the sensor devices on link A at their respective physical I2C slave addresses (<span class="Code_Char">0x1a</span> for sensor1 and <span class="Code_Char">0x62</span> for Ser1), and then updates those physical I2C slave addresses to proxy I2C slave addresses (<span class="Code_Char">0x1b</span> for sensor1 and <span class="Code_Char">0x40</span> for Ser1). Then it performs the same steps for GMSL link B when the sensor device on GMSL link B requests <span class="Code_Char">power_on</span> of the deserializer driver. Finally, it sets up the GMSL link in dual mode. Thus, each device is identified uniquely over the I2C bus. All further device communication takes place on the proxy I2C slave addresses until reboot.</div><div id="wwpID0E0QH0HA" class="Body_Text">The GMSL link addresses are currently programmed at boot time, during probing, due to control configuration timing constraints.</div><div id="wwpID0E0PH0HA" class="Body_Text">The following code is an example of platform device configuration for the GMSL setup shown in the diagrams above. For full details, see the platform device tree file:</div><div id="wwpID0E0OH0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>For Jetson TX2: <span class="Code_Char">tegra186-quill-camera-imx390-a00.dtsi</span></div><div id="wwpID0E0NH0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>For Jetson AGX Xavier: <span class="Code_Char">tegra194-p2822-0000-camera-imx390-a00.dtsi</span></div><div id="wwpID0E0MH0HA" class="Code">tca9546@70 {</div><div id="wwpID0E0LH0HA" class="Code">    /* The deserializer is connected to Tegra Jetson camera connector port via MIPI adapter over pca9546 i2c expander, so all the GMSL device nodes go under here. */</div><div id="wwpID0E0KH0HA" class="Code">    compatible = "nxp,pca9546";</div><div id="wwpID0E0JH0HA" class="Code">    i2c@0 {</div><div id="wwpID0E0IH0HA" class="Code">        /* As in above setup, deserializer (which hosts all the serializers and sensors) is connected to adaptor onto port A, so on i2c expander all the GMSL devices go under i2c@0, the expander assigns 0x30</div><div id="wwpID0E0HH0HA" class="Code">unique address to port 0.*/</div><div id="wwpID0E0GH0HA" class="Code">        reg = &lt;0&gt;;</div><div id="wwpID0E0FH0HA" class="Code">        dser: max9296@48 {</div><div id="wwpID0E0EH0HA" class="Code">            /* single common deserializer at 0x48 */</div><div id="wwpID0E0DH0HA" class="Code">            compatible = "nvidia,max9296";</div><div id="wwpID0E0CH0HA" class="Code">            reg = &lt;0x48&gt;;</div><div id="wwpID0E0BH0HA" class="Code">            csi-mode = "2x4";  /* this tells max CSI lane configuration */</div><div id="wwpID0E0AH0HA" class="Code">            max-src = &lt;2&gt;; /* max sources */</div><div id="wwpID0E06G0HA" class="Code">            /* As deserializer is common among sensor devices, the reset and power rails are controlled via deserializer */</div><div id="wwpID0E05G0HA" class="Code">            reset-gpios = &lt;&amp;tegra_main_gpio CAM0_RST_L GPIO_ACTIVE_HIGH&gt;;</div><div id="wwpID0E04G0HA" class="Code">            vdd_cam_1v2-supply = &lt;&amp;en_vdd_cam_1v2&gt;;</div><div id="wwpID0E03G0HA" class="Code">        };</div><div id="wwpID0E02G0HA" class="Code">&nbsp;</div><div id="wwpID0E01G0HA" class="Code">        ser_prim: max9295_prim@62 { /* Default serializer device */</div><div id="wwpID0E0ZG0HA" class="Code">            compatible = "nvidia,max9295";</div><div id="wwpID0E0YG0HA" class="Code">            reg = &lt;0x62&gt;;</div><div id="wwpID0E0XG0HA" class="Code">            is-prim-ser; /* primary ser device */</div><div id="wwpID0E0WG0HA" class="Code">        };</div><div id="wwpID0E0VG0HA" class="Code">&nbsp;</div><div id="wwpID0E0UG0HA" class="Code">        ser_a: max9295_a@40 {</div><div id="wwpID0E0TG0HA" class="Code">            /* serializer device connected at link A at proxy address 0x40 (the proxy address are assigned runtime) */</div><div id="wwpID0E0SG0HA" class="Code">            compatible = "nvidia,max9295";</div><div id="wwpID0E0RG0HA" class="Code">            reg = &lt;0x40&gt;;</div><div id="wwpID0E0QG0HA" class="Code">            nvidia,gmsl-dser-device = &lt;&amp;dser&gt;; /* link to its deserializer device */</div><div id="wwpID0E0PG0HA" class="Code">        };</div><div id="wwpID0E0OG0HA" class="Code">&nbsp;</div><div id="wwpID0E0NG0HA" class="Code">        ser_b: max9295_b@60 {</div><div id="wwpID0E0MG0HA" class="Code">            /* serializer device connected at link A at proxy address 0x60 (the proxy address is assigned runtime) */</div><div id="wwpID0E0LG0HA" class="Code">            compatible = "nvidia,max9295";</div><div id="wwpID0E0KG0HA" class="Code">            reg = &lt;0x60&gt;;</div><div id="wwpID0E0JG0HA" class="Code">            nvidia,gmsl-dser-device = &lt;&amp;dser&gt;; /* link to its deserializer device */</div><div id="wwpID0E0IG0HA" class="Code">        };</div><div id="wwpID0E0HG0HA" class="Code">&nbsp;</div><div id="wwpID0E0GG0HA" class="Code">        imx390_a@1b {</div><div id="wwpID0E0FG0HA" class="Code">            /* sensor device connected at link A at proxy address 0x1b (the proxy address is assigned runtime). */</div><div id="wwpID0E0EG0HA" class="Code">            def-addr = &lt;0x1a&gt;; /* default slave address is 0x1a */</div><div id="wwpID0E0DG0HA" class="Code">            nvidia,gmsl-ser-device = &lt;&amp;ser_a&gt;; /* link to its serializer device. */</div><div id="wwpID0E0CG0HA" class="Code">            nvidia,gmsl-dser-device = &lt;&amp;dser&gt;; /* link to its deserializer device. */</div><div id="wwpID0E0BG0HA" class="Code">        };</div><div id="wwpID0E0AG0HA" class="Code">&nbsp;</div><div id="wwpID0E06F0HA" class="Code">        imx390_b@1c {</div><div id="wwpID0E05F0HA" class="Code">            /* sensor device connected at link A at proxy address 0x1b (the proxy address are assigned runtime). */</div><div id="wwpID0E04F0HA" class="Code">            def-addr = &lt;0x1a&gt;; /* Default slave address is 0x1a. */</div><div id="wwpID0E03F0HA" class="Code">            /* Define clocks, io pins, power sources */</div><div id="wwpID0E02F0HA" class="Code">            nvidia,gmsl-ser-device = &lt;&amp;ser_b&gt;; /* Link to its serializer device. */</div><div id="wwpID0E01F0HA" class="Code">            nvidia,gmsl-dser-device = &lt;&amp;dser&gt;; /* Link to its deserializer device. */</div><div id="wwpID0E0ZF0HA" class="Code">        };</div><div id="wwpID0E0YF0HA" class="Code">    }; /* i2c@0 closing */</div><div id="wwpID0E0XF0HA" class="Code">};   /* tca9546@70 closing */</div><div id="wwpID0E0WF0HA" class="Heading_5">Module Device Tree</div><div id="wwpID0E0VF0HA" class="Body_Text">After platform device configuration, the device module configuration must be added to the module device tree. For full details, see:</div><div id="wwpID0E0UF0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>For Jetson TX: <span class="Code_Char">tegra186-camera-imx390-a00.dtsi</span></div><div id="wwpID0E0TF0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>For Jetson AGX Xavier: <span class="Code_Char">tegra194-camera-imx390-a00.dtsi</span></div><div id="wwpID0E0SF0HA" class="Body_Text">A few snippets are shown here to illustrate the configuration. The virtual channels are set in the module device tree.</div><div id="wwpID0E0RF0HA" class="Body_Text">The sensor device acts as controller device in the GMSL software framework, so in the module device tree each sensor device node contains a <span class="Code_Char">gmsl-link</span> device node which describes the properties of the GMSL link to which the sensor is connected. In the example below, the <span class="Code_Char">gmsl-link</span> node describes the sensor connected at GMSL link A.</div><div id="wwpID0E0QF0HA" class="Code">gmsl-link {</div><div id="wwpID0E0PF0HA" class="Code">    src-csi-port = "b";     /* Port at which sensor is connected to</div><div id="wwpID0E0OF0HA" class="Code"> its serializer device. */</div><div id="wwpID0E0NF0HA" class="Code">    dst-csi-port = "a";     /* Destination CSI port on the Jetson</div><div id="wwpID0E0MF0HA" class="Code"> side, connected at deserializer. */</div><div id="wwpID0E0LF0HA" class="Code">    serdes-csi-link = "a"; /* GMSL link sensor/serializer connected */</div><div id="wwpID0E0KF0HA" class="Code">    csi-mode = "1x4";      /*  to sensor CSI mode. */</div><div id="wwpID0E0JF0HA" class="Code">    st-vc = &lt;0&gt;;           /* Sensor source default VC ID: 0 unless</div><div id="wwpID0E0IF0HA" class="Code"> overridden by sensor. */</div><div id="wwpID0E0HF0HA" class="Code">    vc-id = &lt;0&gt;;           /* Destination VC ID, assigned to sensor</div><div id="wwpID0E0GF0HA" class="Code"> stream by deserializer. */</div><div id="wwpID0E0FF0HA" class="Code">    num-lanes = &lt;2&gt;;       /* Number of CSI lanes used. */</div><div id="wwpID0E0EF0HA" class="Code">    streams = "ued-u1", "raw12";</div><div id="wwpID0E0DF0HA" class="Code">/* Types of streams sensor is streaming. */</div><div id="wwpID0E0CF0HA" class="Code">};</div><div id="wwpID0E0BF0HA" class="Body_Text">For any GMSL module configuration, all the fields shown above must be set based on the hardware connectivity.</div><div id="wwpID0E0AF0HA" class="Heading_6">Virtual Channel Programming in the Module Device Tree</div><div id="wwpID0E06E0HA" class="Body_Text">You must add the same <span class="Code_Char">vc-id</span> property value to the respective CSI and VI channel nodes in the same module device tree file. This property is used for V4L2 camera use cases.</div><div id="wwpID0E05E0HA" class="Body_Text">You must set the <span style="background-color: #F2F2F2; font-family: &quot;Courier New&quot;">vc-id</span> property in the <span class="Code_Char">gmsl-link</span> node for each sensor to match the <span class="Code_Char">vc_id</span> property in the sensor mode device node.</div><div id="wwpID0E04E0HA" class="Body_Text">The <span class="Code_Char">vc_id</span> property in sensor mode device tree nodes is used for use cases based on the ARGUS camera. For example:</div><div id="wwpID0E03E0HA" class="Code">mode0 { /*mode IMX390_MODE_1920X1080_CROP_30FPS*/</div><div id="wwpID0E02E0HA" class="Code">	mclk_khz = "24000";</div><div id="wwpID0E01E0HA" class="Code">	num_lanes = "2";</div><div id="wwpID0E0ZE0HA" class="Code">	tegra_sinterface = "serial_a";</div><div id="wwpID0E0YE0HA" class="Code">	vc_id = "0";</div><div id="wwpID0E0XE0HA" class="Heading_6">VI and CSI Channel Nodes in the Module Device Tree</div><div id="wwpID0E0WE0HA" class="Body_Text">The module device tree for the reference GMSL setup also performs the port binding to VI and CSI. The number of VI and CSI channels is 2, as in any other dual-sensor setup, but the <span class="Code_Char">port-index</span> field would be set based on the hardware connectivity.</div><div id="wwpID0E0VE0HA" class="Code">vi@15700000 {</div><div id="wwpID0E0UE0HA" class="Code">	num-channels = &lt;2&gt;;</div><div id="wwpID0E0TE0HA" class="Code">	ports {</div><div id="wwpID0E0SE0HA" class="Code">		#address-cells = &lt;1&gt;;</div><div id="wwpID0E0RE0HA" class="Code">		#size-cells = &lt;0&gt;;</div><div id="wwpID0E0QE0HA" class="Code">		port@0 {</div><div id="wwpID0E0PE0HA" class="Code">			reg = &lt;0&gt;;</div><div id="wwpID0E0OE0HA" class="Code">			imx390_vi_in0: endpoint {</div><div id="wwpID0E0NE0HA" class="Code">				vc-id = &lt;0&gt;;</div><div id="wwpID0E0ME0HA" class="Code">				port-index = &lt;0&gt;;</div><div id="wwpID0E0LE0HA" class="Code">				bus-width = &lt;2&gt;;</div><div id="wwpID0E0KE0HA" class="Code">				remote-endpoint = &lt;&amp;imx390_csi_out0&gt;;</div><div id="wwpID0E0JE0HA" class="Code">			};</div><div id="wwpID0E0IE0HA" class="Code">		};</div><div id="wwpID0E0HE0HA" class="Code">		port@1 {</div><div id="wwpID0E0GE0HA" class="Code">			reg = &lt;1&gt;;</div><div id="wwpID0E0FE0HA" class="Code">			imx390_vi_in1: endpoint {</div><div id="wwpID0E0EE0HA" class="Code">				vc-id = &lt;1&gt;;</div><div id="wwpID0E0DE0HA" class="Code">				port-index = &lt;0&gt;;</div><div id="wwpID0E0CE0HA" class="Code">				bus-width = &lt;2&gt;;</div><div id="wwpID0E0BE0HA" class="Code">				remote-endpoint = &lt;&amp;imx390_csi_out1&gt;;</div><div id="wwpID0E0AE0HA" class="Code">			};</div><div id="wwpID0E06D0HA" class="Code">		};</div><div id="wwpID0E05D0HA" class="Code">	};</div><div id="wwpID0E04D0HA" class="Code">};</div><div id="wwpID0E03D0HA" class="Code">&nbsp;</div><div id="wwpID0E02D0HA" class="Code">nvcsi@150c0000 {</div><div id="wwpID0E01D0HA" class="Code">	num-channels = &lt;2&gt;;</div><div id="wwpID0E0ZD0HA" class="Code">	#address-cells = &lt;1&gt;;</div><div id="wwpID0E0YD0HA" class="Code">	#size-cells = &lt;0&gt;;</div><div id="wwpID0E0XD0HA" class="Code">	channel@0 {</div><div id="wwpID0E0WD0HA" class="Code">		reg = &lt;0&gt;;</div><div id="wwpID0E0VD0HA" class="Code">		ports {</div><div id="wwpID0E0UD0HA" class="Code">			#address-cells = &lt;1&gt;;</div><div id="wwpID0E0TD0HA" class="Code">			#size-cells = &lt;0&gt;;</div><div id="wwpID0E0SD0HA" class="Code">			port@0 {</div><div id="wwpID0E0RD0HA" class="Code">				reg = &lt;0&gt;;</div><div id="wwpID0E0QD0HA" class="Code">				imx390_csi_in0: endpoint@0 {</div><div id="wwpID0E0PD0HA" class="Code">					port-index = &lt;0&gt;;</div><div id="wwpID0E0OD0HA" class="Code">					bus-width = &lt;2&gt;;</div><div id="wwpID0E0ND0HA" class="Code">				remote-endpoint = &lt;&amp;imx390_imx390_out0&gt;;</div><div id="wwpID0E0MD0HA" class="Code">				};</div><div id="wwpID0E0LD0HA" class="Code">			};</div><div id="wwpID0E0KD0HA" class="Code">			port@1 {</div><div id="wwpID0E0JD0HA" class="Code">				reg = &lt;1&gt;;</div><div id="wwpID0E0ID0HA" class="Code">				imx390_csi_out0: endpoint@1 {</div><div id="wwpID0E0HD0HA" class="Code">				remote-endpoint = &lt;&amp;imx390_vi_in0&gt;;</div><div id="wwpID0E0GD0HA" class="Code">				};								};</div><div id="wwpID0E0FD0HA" class="Code">		};</div><div id="wwpID0E0ED0HA" class="Code">	};</div><div id="wwpID0E0DD0HA" class="Code">	channel@1 {</div><div id="wwpID0E0CD0HA" class="Code">		reg = &lt;1&gt;;</div><div id="wwpID0E0BD0HA" class="Code">		ports {</div><div id="wwpID0E0AD0HA" class="Code">			#address-cells = &lt;1&gt;;</div><div id="wwpID0E06C0HA" class="Code">			#size-cells = &lt;0&gt;;</div><div id="wwpID0E05C0HA" class="Code">			port@0 {</div><div id="wwpID0E04C0HA" class="Code">				reg = &lt;0&gt;;</div><div id="wwpID0E03C0HA" class="Code">				imx390_csi_in1: endpoint@2 {</div><div id="wwpID0E02C0HA" class="Code">					port-index = &lt;0&gt;;</div><div id="wwpID0E01C0HA" class="Code">					bus-width = &lt;2&gt;;</div><div id="wwpID0E0ZC0HA" class="Code">				remote-endpoint = &lt;&amp;imx390_imx390_out1&gt;;</div><div id="wwpID0E0YC0HA" class="Code">				};</div><div id="wwpID0E0XC0HA" class="Code">			};</div><div id="wwpID0E0WC0HA" class="Code">			port@1 {</div><div id="wwpID0E0VC0HA" class="Code">				reg = &lt;1&gt;;</div><div id="wwpID0E0UC0HA" class="Code">				imx390_csi_out1: endpoint@3 {</div><div id="wwpID0E0TC0HA" class="Code">				remote-endpoint = &lt;&amp;imx390_vi_in1&gt;;</div><div id="wwpID0E0SC0HA" class="Code">				};</div><div id="wwpID0E0RC0HA" class="Code">			};</div><div id="wwpID0E0QC0HA" class="Code">		};</div><div id="wwpID0E0PC0HA" class="Code">	};</div><div id="wwpID0E0OC0HA" class="Code">};</div><div id="wwpID0E0NC0HA" class="Body_Text">In this configuration the <span class="Code_Char">port-index</span> property is set to 0 for both the VI channel 0 and channel 1 nodes, so that both sensors use VI stream 0.</div><div id="wwpID0E0MC0HA" class="Body_Text">For CSI channel 0 and channel 1 nodes too the <span class="Code_Char">port-index</span> property is set to 0, meaning that both channels’ sensors are connected to CSI port A.</div><div id="wwpID0E0LC0HA" class="Body_Text">The VI and CSI channel nodes also both contain a new property, <span class="Code_Char">vc-id</span>, used in V4L2 camera use cases as mentioned above. It must match the <span class="Code_Char">gmsl-link</span> device node’s <span class="Code_Char">vc-id</span>” property.</div><div id="wwpID0E0KC0HA" class="Body_Text">The <span class="Code_Char">bus-width</span> property specifies the number of CSI lanes used.</div><div id="wwpID0E0JC0HA" class="Heading_6">tegra-camera-platform node configuration in module device tree</div><div id="wwpID0E0IC0HA" class="Body_Text">The <span class="Code_Char">TEGRA-CAMERA-platform</span> device node specifies details of the sensor modules’ configuration. The configuration below is for the reference GMSL module:</div><div id="wwpID0E0HC0HA" class="Code">tegra-camera-platform {</div><div id="wwpID0E0GC0HA" class="Code">	compatible = "nvidia, tegra-camera-platform";</div><div id="wwpID0E0FC0HA" class="Code">	num_csi_lanes = &lt;2&gt;;</div><div id="wwpID0E0EC0HA" class="Code">	max_lane_speed = &lt;4000000&gt;;</div><div id="wwpID0E0DC0HA" class="Code">	min_bits_per_pixel = &lt;10&gt;;</div><div id="wwpID0E0CC0HA" class="Code">	vi_peak_byte_per_pixel = &lt;2&gt;;</div><div id="wwpID0E0BC0HA" class="Code">	vi_bw_margin_pct = &lt;25&gt;;</div><div id="wwpID0E0AC0HA" class="Code">	isp_peak_byte_per_pixel = &lt;5&gt;;</div><div id="wwpID0E06B0HA" class="Code">	isp_bw_margin_pct = &lt;25&gt;;</div><div id="wwpID0E05B0HA" class="Code">&nbsp;</div><div id="wwpID0E04B0HA" class="Code">	modules {</div><div id="wwpID0E03B0HA" class="Code">		module0 {</div><div id="wwpID0E02B0HA" class="Code">			badge = "imx390_rear";</div><div id="wwpID0E01B0HA" class="Code">			position = "rear";</div><div id="wwpID0E0ZB0HA" class="Code">			orientation = "1";</div><div id="wwpID0E0YB0HA" class="Code">			drivernode0 {</div><div id="wwpID0E0XB0HA" class="Code">				pcl_id = "v4l2_sensor";</div><div id="wwpID0E0WB0HA" class="Code">				/* Driver v4l2 device name */</div><div id="wwpID0E0VB0HA" class="Code">				devname = "imx390 30-001b";</div><div id="wwpID0E0UB0HA" class="Code">				proc-device-tree = "/proc/device-tree/i2c@3180000/tca9546@70/i2c@0/imx390_a@1b";</div><div id="wwpID0E0TB0HA" class="Code">			};</div><div id="wwpID0E0SB0HA" class="Code">		};</div><div id="wwpID0E0RB0HA" class="Code">		module1 {</div><div id="wwpID0E0QB0HA" class="Code">			badge = "imx390_front";</div><div id="wwpID0E0PB0HA" class="Code">			position = "front";</div><div id="wwpID0E0OB0HA" class="Code">			orientation = "1";</div><div id="wwpID0E0NB0HA" class="Code">			drivernode0 {</div><div id="wwpID0E0MB0HA" class="Code">				pcl_id = "v4l2_sensor";</div><div id="wwpID0E0LB0HA" class="Code">				/* Driver v4l2 device name */</div><div id="wwpID0E0KB0HA" class="Code">				devname = "imx390 30-001c";</div><div id="wwpID0E0JB0HA" class="Code">				proc-device-tree = "/proc/device-tree/i2c@3180000/tca9546@70/i2c@0/imx390_b@1c";</div><div id="wwpID0E0IB0HA" class="Code">			};</div><div id="wwpID0E0HB0HA" class="Code">		};</div><div id="wwpID0E0GB0HA" class="Code">	};</div><div id="wwpID0E0FB0HA" class="Code"> };</div><div id="wwpID0E0EB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span><span class="Code_Char">num_csi_lanes</span> is set to 2, since both sensors are connected to a single CSI port A in x2 lane fashion. This is unlike other dual sensors, where <span class="Code_Char">num_csi_lanes</span> is set to the total number of CSI lanes used by both sensors, since they use different CSI ports.</div><div id="wwpID0E0DB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span><span class="Code_Char">max_lane_speed</span> is set to an appropriate value for two sensors streaming through a single shared port.</div><div id="wwpID0E0CB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>The sensor device nodes are defined using sensor proxy I2C slave addresses instead of their physical I2C slave address, and their paths are set in <span class="Code_Char">proc-device-tree</span> property. Similar naming is used for the <span class="Code_Char">devname</span> property.</div><div id="wwpID0E0BB0HA" class="Body_Text">For the rest of the configuration, follow the same guidelines as for other sensors.</div><div id="wwpID0E0AB0HA" class="Body_Text">Refer to the following module device tree files:</div><div id="wwpID0E6HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>For Jetson TX2: &lt;<span class="Code_Char">tegra186-camera-imx390-a00.dtsi</span>&gt;</div><div id="wwpID0E5HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>For Jetson AGX Xavier: &lt;<span class="Code_Char">tegra194-camera-imx390-a00.dtsi</span>&gt;</div><div id="wwpID0E4HA" class="Heading_5">Plugin Manager Device Tree</div><div id="wwpID0E3HA" class="Body_Text">The device tree additions for Plugin Manager are the same as for any other sensor module.</div><div id="wwpID0E2HA" class="Body_Text">For reference GMSL setup plugin manager support, see the node <span class="Code_Char">fragment-imx390@0</span> in:</div><div id="wwpID0E1HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>For Jetson TX2: <span class="Code_Char">tegra186-quill-camera-plugin-manager.dtsi</span></div><div id="wwpID0EZHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>For Jetson AGX Xavier: <span class="Code_Char">tegra194-camera-plugin-manager.dtsi</span></div><div id="wwpID0EYHA" class="Heading_5">Camera Modules Device Tree</div><div id="wwpID0EXHA" class="Body_Text">All the device nodes in the I2C node of the platform’s camera module device tree are defined in the same way as in the platform device tree. As in the reference GMSL setup, they all go to <span class="Code_Char">i2c@0</span>.</div><div id="wwpID0EWHA" class="Body_Text">The camera module device tree is:</div><div id="wwpID0EVHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-family: &quot;Palatino Linotype&quot;; font-size: 12pt">•	</span></span>For Jetson TX2: <span class="Code_Char">tegra186-quill-camera-modules.dtsi</span></div><div id="wwpID0EUHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>For Jetson AGX Xavier: <span class="Code_Char">tegra194-p2822-camera-modules.dtsi</span></div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 49.5pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 54pt"><div id="wwpID0EABATHA" class="Normal" style="margin-bottom: 0pt; margin-top: 6pt; text-align: center"><span style="font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 315pt"><div id="wwpID0EAAATHA" class="Normal" style="margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">The </span><span class="Code_Char">vc-id</span><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold"> property is set to 0 by default for all VI ports in all modules’ device tree files. You must assign correct values to this property in </span><span class="Code_Char">plugin-manager</span><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold"> and the sensor-specific module device tree file.</span></div></td></tr></table></div><H3 id="wwpID0ESHA" class="Heading_3">Constraints</H3><div id="wwpID0ERHA" class="Body_Text">Sensor streams connected to same CSI aggregator and sharing a CSI port must use the same lane configuration. The deserializer driver fails to register a stream if its lane configuration does not match other streams that share the same deserializer device.</div><div id="wwpID0EQHA" class="Body_Text">Apart from that, CSI aggregators generally support multiple identical cameras running with the same frame rate and sensor mode. Review your aggregator data sheet for additional restrictions if you are using a more complicated configuration.</div><H3 id="wwpID0EPHA" class="Heading_3">Validation</H3><div id="wwpID0EOHA" class="Body_Text">Dual GMSL sensor streaming (preview/capture) is validated using Argus cameras, sharing CSI port A, and the V4L2 application.</div><div id="wwpID0ENHA" class="Body_Text">The 2x CSI deserializer/aggregator is validated. The 4x CSI aggregator is not validated, as its hardware module is currently not available.</div><H3 id="wwpID0EMHA" class="Heading_3">Known Issues</H3><div id="wwpID0ELHA" class="Body_Text">This section summarizes known issues in the GMSL camera framework.</div><H4 id="wwpID0EKHA" class="Heading_4">General Issues</H4><div id="wwpID0EJHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>Preview flickers on scene change.</div><div id="wwpID0EIHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>Sensor tuning and image quality are substandard.</div><H4 id="wwpID0EHHA" class="Heading_4">Xavier-Specific</H4><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 49.5pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 54pt"><div id="wwpID0EABAGHA" class="Normal" style="margin-bottom: 0pt; margin-top: 6pt; text-align: center"><span style="font-family: &quot;Trebuchet MS&quot;; font-weight: bold">Note:</span></div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 310.5pt"><div id="wwpID0EAAAGHA" class="Normal" style="margin-top: 6pt"><span style="font-family: &quot;Trebuchet MS&quot;; font-size: 10pt; font-weight: bold">This limitation and rework only apply to older GMSL kits which do not draw on the on-board (DESER) 1.2&nbsp;V supply.</span></div></td></tr></table></div><div id="wwpID0EFHA" class="Body_Text">The 1.2&nbsp;V power supply needs rework. The MAX9296 deserializer board used in the reference setup does not draw the required on-board 1.2&nbsp;V power, and the Jetson AGX Xavier Developer Kit carrier board has dropped support for supplying 1.2&nbsp;V to the camera connector. (Jetson TX2 does have this support.)</div><div id="wwpID0EEHA" class="Body_Text">The following rework is required on Jetson AGX Xavier for vendor modules that expect 1.2V from the carrier board:</div><div id="wwpID0EDHA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span style="color: #000000; font-size: 12pt">•	</span></span>Use spare LDO for the SATA controller, which can take maximum 1.21&nbsp;V. The V<span style="vertical-align: sub">min</span> requirement from the IMX390 reference sensor is 1.14&nbsp;V, and the range is 1.14&nbsp;V to 1.26&nbsp;V, so this LDO supply is enough to supply 1.2&nbsp;V to the Jetson AGX Xavier carrier  board’s camera connector.</div><H4 id="wwpID0ECHA" class="Heading_4">Plugin Manager Board ID</H4><div id="wwpID0EBHA" class="Body_Text">The reference GMSL module currently does not have a unique board ID. Use the MIPI adapter’s board ID, <span class="Code_Char">LPRD-001</span>. This ID is used by other sensor modules which use similar MIPI adapters, such as IMX274 and IMX185. To work around this issue until it is resolved, the IMX390 module is disabled in these sensor modules; see <span class="Code_Char">tegra186-quill-camera-plugin-manager.dtsi</span>.</div></div><div id="page_dates"></div><!-- Related Topics --><!--                --><footer><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br /></footer></div></div><input type="hidden" id="preserve_unknown_file_links" value="false"></input><noscript><div id="noscript_warning">This site works best with JavaScript enabled</div></noscript><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></body></html>