<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="false" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><!-- NVIDIA customization --><title>NVIDIA Jetson Linux Driver Package Software Features : Kernel Customization | NVIDIA Docs </title><link rel="Prev" href="bootloader_disk_encryption.html" title="Previous" /><link rel="Next" href="kernel_boot_time.html" title="Next" /><link rel="StyleSheet" href="../css/font-awesome/css/font-awesome.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/kernel_custom.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><noscript><div id="noscript_padding"></div></noscript></head><body id="pLsOxGkid90G_002bM12ln_002fK3Bw" class="ww_skin_page_body" style="visibility: hidden;"><input type="hidden" id="page_onload_url" value="../index.html#page/Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html"></input><span id="dropdown_ids" style="display:none;"></span><div id="ww_content_container"><header id="wwconnect_header"><div class="ww_skin_page_toolbar"><div id="dropdown_button_container" class="dropdown_container dropdown_button_container_disabled"><a id="show_hide_all" class="ww_skin ww_behavior_dropdown_toggle ww_skin_dropdown_toggle" title="Page DropDown Toggle" href="#"><i class="fa"></i></a><span class="ww_skin_page_toolbar_divider">&nbsp;</span></div><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#"><i class="fa"></i></a></div><!-- was this helpful button --><!--                         --></header><div id="page_content_container" style="background-attachment: scroll; background-image: url(&quot;watermark.png&quot;); background-position: center center; background-repeat: no-repeat; margin-left: 0pt; margin-right: 10pt; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px"><div id="page_content"><H1 id="wwpID0E0PE0HA" class="Heading_1">Kernel Customization</H1><div class="WebWorks_MiniTOC"><div class="WebWorks_MiniTOC_Heading">&nbsp;</div><dl class="WebWorks_MiniTOC_List"><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0E0NE0HA">Obtaining the Kernel Sources with Git</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0E0CE0HA">Manually Downloading and Expanding Kernel Sources</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0E0WD0HA">Building the NVIDIA Kernel </a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0E0GC0HA">Preparing to Build External Kernel Modules</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0E0LB0HA">Building External Kernel Modules</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0E0EB0HA">How To Enable PMIC-WDT</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0EXHA">Using the L4T Real-Time Kernel Package</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_boot_time.html#wwconnect_header">Kernel Boot Time Optimization</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/display_configuration.html#wwconnect_header">Display Configuration and Bringup</a></div></dd><dd><div class="WebWorks_MiniTOC_Entry"><a class="WebWorks_MiniTOC_Link" href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/xavier_toolchain.html#wwconnect_header">Jetson Linux Toolchain</a></div></dd></dl></div><div id="wwpID0E0OE0HA" class="Body_Text">You can manually rebuild the kernel used for the NVIDIA<span style="vertical-align: super">®</span> Jetson™ Linux Driver Package (L4T). Internet access is required.</div><H2 id="wwpID0E0NE0HA" class="Heading_2">Obtaining the Kernel Sources with Git</H2><div id="wwpID0E0ME0HA" class="Heading_5">Prerequisites</div><div id="wwpID0E0LE0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>You have installed Git. Install Git with the following command:</div><div id="wwpID0E0KE0HA" class="Code">$ sudo apt install git-core</div><div id="wwpID0E0JE0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Your system has the default Git port 9418 open for outbound connections.</div><div id="wwpID0E0IE0HA" class="Heading_5">To sync the kernel sources</div><div id="wwpID0E0HE0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Get the kernel source by running the <span class="Code_Char">source_sync.sh</span> script:</div><div id="wwpID0E0GE0HA" class="Code">$ ./source_sync.sh</div><div id="wwpID0E0FE0HA" class="Number_Continue">When prompted enter a ‘tag’ name, as provided in the release notes. </div><div id="wwpID0E0EE0HA" class="Number_Continue">You can sync to any Linux tag you like. However, the tag provided in the release notes syncs the sources to the same source revision the release binary was built from. To see a list of the available release tags, use:</div><div id="wwpID0E0DE0HA" class="Code">$ git tag –l tegra-l4t*</div><H2 id="wwpID0E0CE0HA" class="Heading_2">Manually Downloading and Expanding Kernel Sources</H2><div id="wwpID0E0BE0HA" class="Body_Text">As an alternative, you can download the kernel source files and then manually extract them. If possible, it is recommended to instead sync with git.</div><div id="wwpID0E0AE0HA" class="Heading_5">To manually download and expand the kernel sources</div><div id="wwpID0E06D0HA" class="List_Number" style="text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>In a browser, navigate to:</div><div id="wwpID0E05D0HA" class="Code"><span class="Hyperlink"><a href="https://developer.nvidia.com/embedded/downloads" target="external_window">https://developer.nvidia.com/embedded/downloads</a></span> </div><div id="wwpID0E04D0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Locate and download the L4T source files for your release.</div><div id="wwpID0E03D0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Extract the TBZ2 file.</div><div id="wwpID0E02D0HA" class="Code">$ tar -xjf public_sources.tbz2</div><div id="wwpID0E01D0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Extract the kernel source file.</div><div id="wwpID0E0ZD0HA" class="Code">$ cd Linux_for_Tegra/source/public</div><div id="wwpID0E0YD0HA" class="Code">$ tar –xjf kernel_src.tbz2</div><div id="wwpID0E0XD0HA" class="List_Continue">The kernel source is extracted to the kernel subdirectory.</div><H2 id="wwpID0E0WD0HA" class="Heading_2">Building the NVIDIA Kernel </H2><div id="wwpID0E0UD0HA" class="Body_Text">Follow the steps in this procedure to build the NVIDIA kernel.</div><div id="wwpID0E0TD0HA" class="Heading_5">Prerequisites</div><div id="wwpID0E0SD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>You have downloaded the kernel source code.</div><div id="wwpID0E0RD0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>You have installed the utilities required by the kernel build process.</div><div id="wwpID0E0QD0HA" class="List_Continue">Install the utilities with the command:</div><div id="wwpID0E0PD0HA" class="Code">$ sudo apt install build-essential bc</div><div id="wwpID0E0OD0HA" class="Heading_5">To build the Jetson Linux Kernel</div><div id="wwpID0E0ND0HA" class="List_Number" style="text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Set the shell variable with the command:</div><div id="wwpID0E0MD0HA" class="Code">$ TEGRA_KERNEL_OUT=&lt;outdir&gt;</div><div id="wwpID0E0LD0HA" class="List_Continue">Where:</div><div id="wwpID0E0KD0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;outdir&gt;</span> is the desired destination for the compiled kernel.</div><div id="wwpID0E0JD0HA" class="List_Number" style="text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>If cross-compiling on a non-Jetson system, export the following environment variables:</div><div id="wwpID0E0ID0HA" class="Code">$ export CROSS_COMPILE=&lt;cross_prefix&gt;</div><div id="wwpID0E0HD0HA" class="Code">$ export LOCALVERSION=-tegra</div><div id="wwpID0E0GD0HA" class="Number_Continue">Where:</div><div id="wwpID0E0FD0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;cross_prefix&gt;</span> is the absolute path of the ARM64 toolchain without the <span class="Code_Char">gcc</span> suffix. For example, for the reference ARM64 toolchain, <span class="Code_Char">&lt;cross_prefix&gt;</span> is:</div><div id="wwpID0E0ED0HA" class="Code_Indent">&lt;toolchain_install_path&gt;/bin/aarch64-linux-gnu-</div><div id="wwpID0E0DD0HA" class="List_Continue_2">See <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/xavier_toolchain.html#" title="Jetson Linux Toolchain">The L4T Toolchain</a></span> for information on how to download and build the reference toolchains.</div><div class="ww_skin_page_overflow"><table class="Table_Normal" style="margin-left: 72pt" cellspacing="0" summary=""><tr><td style="background-color: #76B900; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 49.5pt"><div id="wwpID0EABA0CD0HA" class="Note_Image">Note:</div></td><td style="background-color: #DDEEBF; background-position: right center; border-bottom-color: Silver; border-bottom-style: solid; border-bottom-width: thin; border-left-color: Silver; border-left-style: solid; border-left-width: thin; border-right-color: Silver; border-right-style: solid; border-right-width: thin; border-top-color: Silver; border-top-style: solid; border-top-width: thin; padding-bottom: 3pt; padding-left: 3pt; padding-right: 3pt; padding-top: 3pt; vertical-align: top; width: 306.9pt"><div id="wwpID0EAAA0CD0HA" class="Note_Text">NVIDIA recommends using the Linaro 7.3.1 2018.05 toolchain.</div></td></tr></table></div><div id="wwpID0E0BD0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Execute the following commands to create the <span class="Code_Char">.config</span><span class="Body_Text_Char"> file</span>:</div><div id="wwpID0E0AD0HA" class="Code">$ cd &lt;kernel_source&gt;</div><div id="wwpID0E06C0HA" class="Code">$ mkdir -p $TEGRA_KERNEL_OUT</div><div id="wwpID0E05C0HA" class="Code">$ make ARCH=arm64 O=$TEGRA_KERNEL_OUT tegra_defconfig</div><div id="wwpID0E04C0HA" class="List_Continue">Where:</div><div id="wwpID0E03C0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Code_Char">&lt;kernel_source&gt;</span> directory contains the kernel sources (e.g. <span class="Code_Char">kernel-4.9</span>).</div><div id="wwpID0E02C0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Execute the following commands to build the kernel including all DTBs and modules:</div><div id="wwpID0E01C0HA" class="Code">$ make ARCH=arm64 O=$TEGRA_KERNEL_OUT -j&lt;n&gt;</div><div id="wwpID0E0ZC0HA" class="List_Continue">Where <span class="Code_Char">&lt;n&gt;</span> indicates the number of parallel processes to be used. A typical value is the number of CPUs in your system.</div><div id="wwpID0E0YC0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>5.	</span></span>Replace <span class="Code_Char">&lt;release_packagep&gt;/Linux_for_Tegra/kernel/Image</span> with a copy of:</div><div id="wwpID0E0XC0HA" class="Code">$TEGRA_KERNEL_OUT/arch/arm64/boot/Image</div><div id="wwpID0E0WC0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>6.	</span></span>Replace the contents of <span class="Code_Char">Linux_for_Tegra/kernel/dtb/</span> with the contents of:</div><div id="wwpID0E0VC0HA" class="Code">$TEGRA_KERNEL_OUT/arch/arm64/boot/dts/</div><div id="wwpID0E0UC0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>7.	</span></span>Execute the following commands to install the kernel modules:</div><div id="wwpID0E0TC0HA" class="Code">$ sudo make ARCH=arm64 O=$TEGRA_KERNEL_OUT modules_install \</div><div id="wwpID0E0SC0HA" class="Code">    INSTALL_MOD_PATH=&lt;top&gt;/Linux_for_Tegra/rootfs/</div><div id="wwpID0E0RC0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>8.	</span></span>Optionally, archive the installed kernel modules using the following command:</div><div id="wwpID0E0QC0HA" class="Code">$ cd &lt;modules_install_path&gt;</div><div id="wwpID0E0PC0HA" class="Code">$ tar --owner root --group root -cjf kernel_supplements.tbz2 \</div><div id="wwpID0E0OC0HA" class="Code">    lib/modules</div><div id="wwpID0E0NC0HA" class="List_Continue">The installed modules can be used to provide the contents of <span class="Code_Char">/lib/modules/&lt;kernel_version&gt;</span> on the target system.</div><div id="wwpID0E0MC0HA" class="List_Continue">Use the archive to replace the one in the kernel directory of the extracted release package prior to running <span class="Code_Char">apply_binaries.sh</span>:</div><div id="wwpID0E0LC0HA" class="Code">Linux_for_Tegra/kernel/kernel_supplements.tbz2</div><div id="wwpID0E0KC0HA" class="Heading_5">To sign and encrypt kernel, kernel-dtb, and initrd binary files</div><div id="wwpID0E0JC0HA" class="Body_Text_Indent"><span class="Strong">Applies to</span>: Jetson Xavier NX and Jetson AGX Xavier series</div><div id="wwpID0E0IC0HA" class="Cp">To support Secureboot, the <span class="Code_Char">kernel</span>, <span class="Code_Char">kernel-dtb</span>, and <span class="Code_Char">initrd</span> binary files must be signed and encrypted with keys to generate encrypted binary files and signature files.</div><div id="wwpID0E0HC0HA" class="Cp">See the section <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/bootloader_secure_boot.html#wwpID0ESHA" title="Secureboot">Signing and Encrypting kernel, kernel-dtb, and initrd Binary Files</a></span> in the topic <span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/bootloader_secure_boot.html#" title="Secureboot">Secureboot</a></span>.</div><H2 id="wwpID0E0GC0HA" class="Heading_2">Preparing to Build External Kernel Modules</H2><div id="wwpID0E0FC0HA" class="Body_Text">These procedures describe how to prepare a set of kernel headers, or a kernel source tree to allow building an out-of-tree kernel module.</div><div id="wwpID0E0EC0HA" class="Heading_5">To prepare the L4T kernel headers on a Jetson system</div><div id="wwpID0E0DC0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>On a Jetson system you can use the files in this directory to build out-of-tree modules without further action:</div><div id="wwpID0E0CC0HA" class="Code">/usr/src/linux-headers-$(uname -r)-ubuntu18.04_aarch64</div><div id="wwpID0E0BC0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>To build out-of-tree modules, specify the kernel directory as:</div><div id="wwpID0E0AC0HA" class="Body_Text_Indent"><span class="Code_Char">/usr/src/linux-headers-$(uname -r)-ubuntu18.04_aarch64</span><br />or<br /><span class="Code_Char">/lib/modules/$(uname -r)/build</span></div><div id="wwpID0E06B0HA" class="Heading_5">To prepare the Jetson Linux kernel headers on a non-Jetson system</div><div id="wwpID0E05B0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>Extract the following archive and place it in a local directory with the commands:</div><div id="wwpID0E04B0HA" class="Code">$ cd &lt;local_src_dir&gt;</div><div id="wwpID0E03B0HA" class="Code">$ tar -xjf &lt;top&gt;/Linux_for_Tegra/kernel/kernel_headers.tbz2</div><div id="wwpID0E02B0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>You can use the files in this directory to build out-of-tree modules without further action:</div><div id="wwpID0E01B0HA" class="Code">&lt;local_src_dir&gt;/linux-headers-$(uname -r)-linux_x86_64</div><div id="wwpID0E0ZB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>To build out-of-tree modules, specify the kernel directory as:</div><div id="wwpID0E0YB0HA" class="Code"><span class="Code_Char">&lt;local src dir&gt;/</span>linux-headers-$(uname -r)-linux_x86_64</div><div id="wwpID0E0XB0HA" class="Heading_5">To use a manually built NVIDIA kernel source tree</div><div id="wwpID0E0WB0HA" class="List_Bullet"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span>If you built the NVIDIA kernel from source, use the same source tree when building out-of-tree kernel modules. When building out-of-tree modules, specify <span class="Code_Char">$TEGRA_KERNEL_OUT</span> as kernel directory.</div><div id="wwpID0E0VB0HA" class="Heading_5">To prepare an NVIDIA kernel source tree that is not built</div><div id="wwpID0E0UB0HA" class="Body_Text">You can build out-of-tree modules that are compatible with a Linux kernel source tree without building the entire kernel image.</div><div id="wwpID0E0TB0HA" class="List_Number" style="text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>To extract the kernel source, set any required shell or environment variables, and create the <span class="Code_Char">.config</span> file, follow the instructions provided in the following topics:</div><div id="wwpID0E0SB0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0E0NE0HA" title="Kernel Customization">Obtaining the Kernel Sources with Git</a></span></div><div id="wwpID0E0RB0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0E0CE0HA" title="Kernel Customization">Manually Downloading and Expanding Kernel Sources</a></span></div><div id="wwpID0E0QB0HA" class="List_Bullet_2"><span class="WebWorks_Number" style="width: 18pt"><span>•	</span></span><span class="Hyperlink"><a href="../Tegra%20Linux%20Driver%20Package%20Development%20Guide/kernel_custom.html#wwpID0E0WD0HA" title="Kernel Customization">Building the NVIDIA Kernel</a></span></div><div id="wwpID0E0PB0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Execute the following command to prepare the kernel source tree for building out-of-tree kernel modules:</div><div id="wwpID0E0OB0HA" class="Code">$ make ARCH=arm64 O=$TEGRA_KERNEL_OUT -j&lt;n&gt; modules_prepare</div><div id="wwpID0E0NB0HA" class="List_Continue">Where <span class="Code_Char">&lt;n&gt;</span> indicates the number of parallel processes to be used. A typical value is the number of CPUs in your system.</div><div id="wwpID0E0MB0HA" class="List_Continue">When building out-of-tree modules, specify <span class="Code_Char">$TEGRA_KERNEL_OUT</span> as the kernel directory.</div><H2 id="wwpID0E0LB0HA" class="Heading_2">Building External Kernel Modules</H2><div id="wwpID0E0KB0HA" class="Body_Text">If cross-compiling, ensure that the <span class="Code_Char">CROSS_COMPILE</span> environment variable is set as described in previous sections.</div><div id="wwpID0E0JB0HA" class="Body_Text">Execute the following commands to build an out-of-tree kernel module:</div><div id="wwpID0E0IB0HA" class="Code">$ cd &lt;path_to_module_source&gt;</div><div id="wwpID0E0HB0HA" class="Code">$ make ARCH=arm64 –C &lt;kernel_directory&gt; M=$(pwd)</div><div id="wwpID0E0GB0HA" class="Body_Text">Execute the following commands to strip unneeded symbols from the kernel module:</div><div id="wwpID0E0FB0HA" class="Code">$ &lt;tool_chain_path&gt;/aarch64-linux-gnu-strip -–strip-unneeded &lt;path-of-kernel-module.ko&gt;</div><H2 id="wwpID0E0EB0HA" class="Heading_2">How To Enable PMIC-WDT</H2><div id="wwpID0E0DB0HA" class="Body_Text">To enable PMIC-WDT:</div><div id="wwpID0E0CB0HA" class="List_Number" style="text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Change ODM data: set ODM data bits 17:16 to 0b10 before flashing in conf file. (This enables PMIC-WDT and disables Tegra-WDT.)</div><div id="wwpID0E0BB0HA" class="List_Continue">In the file <span class="Code_Char">sudo vim p2771-0000.conf.common</span>, replace 0x1090000 with 0x10a0000.</div><div id="wwpID0E0AB0HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Enter the command:</div><div id="wwpID0E6HA" class="Code">echo 0 &gt; /sys/module/kernel/parameters/panic</div><div id="wwpID0E5HA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Enter the command:</div><div id="wwpID0E4HA" class="Code">cat /dev/watchdog</div><div id="wwpID0E3HA" class="List_Continue">or</div><div id="wwpID0E2HA" class="Code">echo c &gt; /proc/sysrq-trigger</div><div id="wwpID0E1HA" class="List_Continue">(The latter command causes the system to crash.)</div><div id="wwpID0EZHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Wait for two minutes. The device reboots. With this reboot, UART logs begin to appear in the mb2 logs:</div><div id="wwpID0EYHA" class="Code">[0000.203] I&gt; pmic: reset reason (nverc)        : 0x2</div><H2 id="wwpID0EXHA" class="Heading_2">Using the L4T Real-Time Kernel Package</H2><div id="wwpID0EWHA" class="Body_Text_Indent"><span class="Strong">Applies to</span>: Jetson AGX Xavier series only</div><div id="wwpID0EVHA" class="Body_Text">NVIDIA<span style="vertical-align: super">®</span> Jetson AGX Xavier™ series processors officially support the NVIDIA real-time kernel from release 32.5. This section explains how to install and remove L4T real-time kernel packages on your system through the NVIDIA repository.</div><div id="wwpID0EUHA" class="Heading_5">Prerequisites</div><div id="wwpID0ETHA" class="Body_Text">You must upgrade all L4T packages to the same point release version as the real-time kernel.</div><div id="wwpID0ESHA" class="Heading_5">To install the real-time kernel package</div><div id="wwpID0ERHA" class="List_Number" style="text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Open the <span class="Code_Char">apt</span> source configuration file in a text editor, for example:</div><div id="wwpID0EQHA" class="Code">$ sudo vi /etc/apt/sources.list.d/nvidia-l4t-apt-source.list</div><div id="wwpID0EPHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Add a new entry for the <span class="Code_Char">rt-kernel</span> repo:</div><div id="wwpID0EOHA" class="Code">deb https://repo.download.nvidia.com/jetson/rt-kernel r32.5 main</div><div id="wwpID0ENHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>3.	</span></span>Enter this command:</div><div id="wwpID0EMHA" class="Code">$ sudo apt update</div><div id="wwpID0ELHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>4.	</span></span>Install the real-time kernel packages:</div><div id="wwpID0EKHA" class="Code">$ sudo apt install nvidia-l4t-rt-kernel nvidia-l4t-rt-kernel-headers</div><div id="wwpID0EJHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>5.	</span></span>Reboot</div><div id="wwpID0EIHA" class="Heading_5">To remove the real-time kernel package</div><div id="wwpID0EHHA" class="List_Number" style="text-indent: -18pt"><span class="WebWorks_Number" style="width: 18pt"><span>1.	</span></span>Enter this command:</div><div id="wwpID0EGHA" class="Code">$ sudo apt remove nvidia-l4t-rt-kernel nvidia-l4t-rt-kernel-headers</div><div id="wwpID0EFHA" class="List_Number"><span class="WebWorks_Number" style="width: 18pt"><span>2.	</span></span>Reboot.</div><div id="wwpID0EEHA" class="Heading_5">To switch to a different kernel</div><div id="wwpID0EDHA" class="Body_Text">Once you have installed the real-time kernel on your device, you may want to switch between the real-time kernel image and the original generic kernel image without re-installing or removing kernel packages. You can do this by editing <span class="Code_Char">/boot/extlinux/extlinux.conf</span> and setting the <span class="Code_Char">DEFAULT</span> property to specify the kernel you want to boot. Set <span class="Code_Char">DEFAULT</span> to <span class="Code_Char">real-time</span> for the real-time kernel, or to primary for the generic kernel.</div><div id="wwpID0ECHA" class="Code">TIMEOUT 30</div><div id="wwpID0EBHA" class="Code">DEFAULT real-time</div></div><div id="page_dates"></div><!-- Related Topics --><!--                --><footer><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><br /></footer></div></div><input type="hidden" id="preserve_unknown_file_links" value="false"></input><noscript><div id="noscript_warning">This site works best with JavaScript enabled</div></noscript><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></body></html>